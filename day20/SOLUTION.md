# Day 20
## Solution
Open [final.pcap](./final.pcap) with the newest version of Wireshark and enter `tcp.stream` to watch all TCP streams. Right-click on the first entry and select `Follow TCP Stream`. Watch TCP stream 2 and you will find an RAR file. Dump it by selecting `View raw data` first and then clicking `Save as...` to save the file. You can casually name it `a.rar`. Try to extract the RAR file but you find that a password is necessary. But where is the password? Watch TCP stream 5 and you will find the password as `0rvWprrs0NOz9se9wLQ=`. (Just ignore the `EOF`.) Obviously the password is in Base64. Decode it simply by using python and you will find a hex string `\xd2\xbb\xd6\xa6\xba\xec\xd0\xd3\xb3\xf6\xc7\xbd\xc0\xb4`. To know the content of the password you had better type them in hex editors like 010 Editor. You will see the password (`一枝红杏出墙来`) in Chinese in the right-hand panel. Use this password to extract the RAR file and you will get a file with filename `66666666666`. You find that you cannot open it. View it in 010 Editor and you will find `IHDR` at the beginning, which shows that this file is a PNG file. However, its header is corrupted so you have to patch it. Search `PNG header` on the Internet and you will get `89504E47`. Edit the file using 010 Editor and write `89504E47` at the first four bytes of the file to patch the PNG file. You then need to rename the file and append a `.png` suffix to the filename. Then you can successfully open the PNG file and you can see the flag.
